{% extends 'blog/base.html' %}

{% block title %}{{ post.title }}{% endblock %}

{% block content %}

<style>
    .long-text {
        word-wrap: break-word;
        word-break: break-word;
    }
    .comment-box {
        background-color: #f8f9fa;
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 20px;
    }
    .comment-box small {
        display: block;
        color: #6c757d;
    }
    .post-content {
        background-color: #ffffff;
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    }
</style>

<div class="container my-5">
    <!-- Título do Post -->
    <div class="post-content">
        <h1 class="mb-4">{{ post.title }}</h1>

        <!-- Conteúdo do Post com quebra automática de palavras longas -->
        <p class="long-text">{{ post.content }}</p>

        <!-- Imagem do Post, se houver -->
        {% if post.image %}
            <div class="text-center my-4">
                <img src="{{ post.image.url }}" alt="{{ post.title }}" class="img-fluid rounded">
            </div>
        {% endif %}

        <!-- Botões de Edição e Exclusão para o Autor ou Superusuário -->
        {% if request.user == post.author or request.user.is_superuser %}
            <div class="mt-4">
                <a href="{% url 'edit_post' pk=post.pk %}" class="btn btn-warning">Edit Post</a>
                <a href="{% url 'delete_post' pk=post.pk %}" class="btn btn-danger">Delete Post</a>
            </div>
        {% endif %}
    </div>

    <hr class="my-5">

    <!-- Seção de Comentários -->
    <h3 class="mb-4">Comments</h3>
    <ul class="list-unstyled">
        {% for comment in comments %}
            <li class="comment-box">
                <strong>{{ comment.user.username }}</strong>
                <p>{{ comment.content }}</p>
                <small>Posted on {{ comment.created_at }}</small>
            </li>
        {% empty %}
            <li>No comments yet.</li>
        {% endfor %}
    </ul>

    <hr class="my-5">

    <!-- Adicionar Comentário -->
    <h3 class="mb-4">Add your comment</h3>
    {% if user.is_authenticated %}
        <form method="post" class="mb-4">
            {% csrf_token %}
            <div class="mb-3">
                {{ comment_form.as_p }}
            </div>
            <button type="submit" class="btn btn-primary">Submit Comment</button>
        </form>
    {% else %}
        <p>Please <a href="{% url 'login' %}">login</a> to add a comment.</p>
    {% endif %}
</div>

{% endblock %}
